#!/bin/bash

printf "\e[49m                \e[38;2;161;94;196;49m▄\e[38;2;158;97;197;49m▄\e[38;2;151;100;195;49m▄\e[49m                \e[m
\e[49m              \e[38;2;166;94;196;49m▄\e[38;2;161;96;196;48;2;164;95;196m▄\e[38;2;156;98;197;48;2;159;96;197m▄\e[38;2;152;99;197;48;2;154;98;197m▄\e[38;2;147;101;198;48;2;150;100;198m▄\e[38;2;142;103;199;48;2;145;101;199m▄\e[38;2;138;105;201;49m▄\e[49m              \e[m
\e[49m            \e[38;2;169;90;193;49m▄\e[38;2;165;94;196;48;2;168;93;196m▄\e[38;2;160;96;196;48;2;163;95;196m▄\e[38;2;156;98;197;48;2;159;97;197m▄\e[38;2;151;99;198;48;2;154;98;197m▄\e[38;2;146;101;198;48;2;149;100;198m▄\e[38;2;141;104;199;48;2;144;103;199m▄\e[38;2;136;106;200;48;2;139;105;199m▄\e[38;2;132;108;200;48;2;134;107;200m▄\e[38;2;127;110;201;48;2;131;108;202m▄\e[38;2;123;110;200;49m▄\e[49m            \e[m
\e[49m           \e[38;2;169;92;195;48;2;173;90;195m▄\e[38;2;164;94;195;48;2;167;93;195m▄\e[38;2;160;96;196;48;2;163;95;196m▄\e[38;2;155;98;197;48;2;158;97;197m▄\e[38;2;150;100;198;48;2;153;99;197m▄\e[38;2;145;102;199;48;2;148;101;198m▄\e[38;2;141;104;199;48;2;143;103;199m▄\e[38;2;136;106;200;48;2;139;105;199m▄\e[38;2;131;108;200;48;2;134;107;200m▄\e[38;2;127;110;201;48;2;129;109;201m▄\e[38;2;122;112;202;48;2;125;111;202m▄\e[38;2;117;114;203;48;2;119;112;201m▄\e[38;2;113;116;202;48;2;115;115;197m▄\e[49m           \e[m
\e[49m          \e[38;2;168;92;195;48;2;170;91;195m▄\e[38;2;164;94;196;48;2;166;94;195m▄\e[38;2;159;96;196;48;2;162;95;196m▄\e[38;2;155;98;197;48;2;157;97;197m▄\e[38;2;150;100;198;48;2;152;99;197m▄\e[38;2;146;103;200;48;2;147;101;197m▄\e[49;38;2;147;102;198m▀\e[49m \e[49;38;2;134;108;204m▀\e[38;2;125;113;202;48;2;128;109;200m▄\e[38;2;121;112;202;48;2;124;111;202m▄\e[38;2;116;114;203;48;2;119;113;202m▄\e[38;2;111;116;203;48;2;114;116;203m▄\e[38;2;107;118;204;48;2;110;117;204m▄\e[38;2;102;121;205;48;2;106;118;203m▄\e[49m          \e[m
\e[49m        \e[38;2;168;93;193;49m▄\e[38;2;168;92;195;48;2;169;92;196m▄\e[38;2;163;95;196;48;2;165;93;195m▄\e[38;2;158;96;196;48;2;161;96;196m▄\e[38;2;154;98;197;48;2;156;97;197m▄\e[38;2;149;100;198;48;2;152;99;198m▄\e[49;38;2;149;102;197m▀\e[49m     \e[49;38;2;119;111;201m▀\e[38;2;110;116;203;48;2;114;115;203m▄\e[38;2;106;119;204;48;2;109;117;204m▄\e[38;2;101;121;205;48;2;104;119;204m▄\e[38;2;97;123;206;48;2;99;121;205m▄\e[38;2;93;125;207;48;2;94;123;205m▄\e[38;2;88;128;207;49m▄\e[49m        \e[m
\e[49m       \e[38;2;169;92;197;49m▄\e[38;2;167;93;195;48;2;169;92;195m▄\e[38;2;162;95;196;48;2;165;94;196m▄\e[38;2;158;97;197;48;2;160;96;196m▄\e[38;2;153;99;197;48;2;155;98;197m▄\e[38;2;150;100;197;48;2;151;100;197m▄\e[49m    \e[38;2;122;111;200;49m▄\e[49m    \e[38;2;101;121;207;48;2;103;120;204m▄\e[38;2;96;123;206;48;2;98;122;205m▄\e[38;2;91;125;206;48;2;94;124;206m▄\e[38;2;86;127;207;48;2;89;126;207m▄\e[38;2;82;129;208;48;2;84;128;208m▄\e[38;2;79;129;208;49m▄\e[49m       \e[m
\e[49m      \e[38;2;169;90;195;49m▄\e[38;2;166;93;195;48;2;168;92;195m▄\e[38;2;161;95;196;48;2;164;94;196m▄\e[38;2;157;97;197;48;2;159;96;196m▄\e[38;2;152;99;197;48;2;155;98;197m▄\e[38;2;147;98;196;48;2;151;99;199m▄\e[49m   \e[38;2;127;108;202;49m▄\e[38;2;123;111;201;48;2;127;112;201m▄\e[38;2;119;113;202;48;2;121;112;202m▄\e[38;2;114;115;203;48;2;118;113;203m▄\e[38;2;109;116;204;49m▄\e[49m   \e[38;2;91;128;209;48;2;92;124;206m▄\e[38;2;86;127;207;48;2;88;126;207m▄\e[38;2;81;129;208;48;2;84;128;208m▄\e[38;2;76;132;209;48;2;79;130;208m▄\e[38;2;72;134;210;48;2;74;132;209m▄\e[38;2;67;136;210;49m▄\e[49m      \e[m
\e[49m     \e[38;2;168;92;196;48;2;170;85;187m▄\e[38;2;165;94;195;48;2;168;93;196m▄\e[38;2;161;96;196;48;2;164;94;196m▄\e[38;2;156;97;197;48;2;159;97;197m▄\e[38;2;151;99;198;48;2;154;98;197m▄\e[38;2;151;104;198;48;2;151;98;197m▄\e[49m   \e[38;2;128;110;202;49m▄\e[38;2;123;111;202;48;2;125;111;202m▄\e[38;2;118;114;203;48;2;121;112;202m▄\e[38;2;113;116;203;48;2;116;114;203m▄\e[38;2;109;118;204;48;2;112;116;203m▄\e[38;2;104;120;204;48;2;107;119;204m▄\e[38;2;98;121;204;49m▄\e[49m   \e[38;2;82;137;209;48;2;83;128;208m▄\e[38;2;76;132;209;48;2;78;131;208m▄\e[38;2;71;134;209;48;2;73;133;209m▄\e[38;2;66;136;210;48;2;69;134;210m▄\e[38;2;61;138;211;48;2;64;137;210m▄\e[38;2;58;140;211;49m▄\e[49m     \e[m
\e[49m    \e[38;2;168;93;194;49m▄\e[38;2;165;94;196;48;2;167;92;195m▄\e[38;2;160;96;196;48;2;163;95;196m▄\e[38;2;155;98;197;48;2;158;96;196m▄\e[38;2;150;100;198;48;2;153;98;197m▄\e[38;2;140;102;191;48;2;148;101;199m▄\e[49m   \e[38;2;127;110;200;48;2;124;111;196m▄\e[38;2;122;112;202;48;2;125;111;201m▄\e[38;2;117;114;203;48;2;120;113;202m▄\e[38;2;113;116;203;48;2;115;115;203m▄\e[38;2;108;118;204;48;2;111;117;204m▄\e[38;2;103;120;205;48;2;106;119;204m▄\e[38;2;98;122;205;48;2;101;121;205m▄\e[38;2;94;124;206;48;2;96;122;206m▄\e[38;2;89;127;207;48;2;94;121;201m▄\e[49m   \e[38;2;64;140;217;48;2;73;132;210m▄\e[38;2;65;136;210;48;2;68;135;210m▄\e[38;2;60;138;211;48;2;63;137;211m▄\e[38;2;56;140;212;48;2;58;139;211m▄\e[38;2;51;142;212;48;2;54;141;212m▄\e[38;2;47;144;213;49m▄\e[49m    \e[m
\e[49m   \e[38;2;168;92;194;49m▄\e[38;2;164;94;196;48;2;167;93;195m▄\e[38;2;159;96;196;48;2;162;95;196m▄\e[38;2;155;98;197;48;2;157;97;197m▄\e[38;2;150;100;198;48;2;153;99;197m▄\e[49;38;2;147;101;198m▀\e[49m   \e[38;2;125;111;201;48;2;128;109;198m▄\e[38;2;122;112;202;48;2;124;111;202m▄\e[38;2;116;114;203;48;2;119;113;202m▄\e[38;2;112;116;204;48;2;114;115;203m▄\e[38;2;107;118;204;48;2;110;117;204m▄\e[38;2;102;120;205;48;2;105;119;204m▄\e[38;2;98;122;205;48;2;100;121;205m▄\e[38;2;93;124;206;48;2;96;123;206m▄\e[38;2;88;126;207;48;2;91;125;206m▄\e[38;2;84;129;208;48;2;86;127;207m▄\e[38;2;82;129;208;48;2;87;130;212m▄\e[49m   \e[49;38;2;62;137;210m▀\e[38;2;55;140;212;48;2;58;139;211m▄\e[38;2;50;142;213;48;2;53;142;212m▄\e[38;2;45;144;213;48;2;48;143;213m▄\e[38;2;41;146;214;48;2;44;145;213m▄\e[38;2;34;147;213;49m▄\e[49m   \e[m
\e[49m  \e[38;2;156;85;198;49m▄\e[38;2;163;94;196;48;2;166;94;196m▄\e[38;2;159;97;197;48;2;161;95;196m▄\e[38;2;154;98;197;48;2;157;97;197m▄\e[38;2;149;101;198;48;2;152;99;197m▄\e[38;2;145;100;197;48;2;148;101;198m▄\e[49m    \e[38;2;120;112;201;48;2;123;111;203m▄\e[38;2;116;115;203;48;2;119;113;202m▄\e[38;2;111;116;203;48;2;114;116;203m▄\e[38;2;106;119;204;48;2;109;117;204m▄\e[38;2;102;121;205;48;2;105;119;205m▄\e[38;2;97;123;206;48;2;99;122;205m▄\e[38;2;92;124;206;48;2;95;123;206m▄\e[38;2;88;127;207;48;2;90;126;207m▄\e[38;2;83;128;208;48;2;85;128;207m▄\e[38;2;78;130;208;48;2;81;129;208m▄\e[38;2;73;131;208;48;2;76;131;209m▄\e[49m    \e[38;2;48;142;213;48;2;51;142;212m▄\e[38;2;45;145;213;48;2;48;144;213m▄\e[38;2;40;147;214;48;2;43;145;214m▄\e[38;2;35;149;215;48;2;38;147;214m▄\e[38;2;31;151;215;48;2;34;150;215m▄\e[38;2;28;156;213;49m▄\e[49m  \e[m
\e[49m  \e[38;2;162;95;196;48;2;164;93;195m▄\e[38;2;158;97;197;48;2;161;96;196m▄\e[38;2;153;99;197;48;2;156;98;197m▄\e[38;2;148;101;198;48;2;151;100;198m▄\e[38;2;144;102;199;48;2;146;102;198m▄\e[49m       \e[49;38;2;107;115;202m▀\e[49;38;2;104;120;204m▀\e[49;38;2;99;122;205m▀\e[49;38;2;94;123;205m▀\e[49;38;2;89;124;206m▀\e[49;38;2;86;126;207m▀\e[49;38;2;81;130;206m▀\e[49m       \e[38;2;39;146;214;48;2;42;146;214m▄\e[38;2;34;149;215;48;2;37;148;214m▄\e[38;2;30;151;215;48;2;33;150;215m▄\e[38;2;25;153;216;48;2;28;152;216m▄\e[38;2;20;155;217;48;2;23;154;215m▄\e[49m  \e[m
\e[49m \e[38;2;160;95;197;48;2;161;93;195m▄\e[38;2;157;97;197;48;2;160;96;196m▄\e[38;2;152;99;198;48;2;155;98;197m▄\e[38;2;148;101;198;48;2;151;100;198m▄\e[38;2;143;103;199;48;2;145;102;198m▄\e[38;2;138;105;200;48;2;142;105;199m▄\e[38;2;134;107;200;49m▄\e[49m                   \e[38;2;37;148;215;49m▄\e[38;2;34;149;215;48;2;37;148;215m▄\e[38;2;29;151;215;48;2;32;150;215m▄\e[38;2;24;153;216;48;2;27;152;216m▄\e[38;2;20;155;217;48;2;23;154;217m▄\e[38;2;15;158;218;48;2;17;156;217m▄\e[38;2;11;160;219;48;2;13;157;217m▄\e[49m \e[m
\e[49m \e[38;2;156;98;196;48;2;159;96;197m▄\e[38;2;151;99;197;48;2;155;98;197m▄\e[38;2;147;101;198;48;2;150;100;198m▄\e[38;2;142;104;199;48;2;145;102;199m▄\e[38;2;137;105;200;48;2;140;104;199m▄\e[38;2;133;107;200;48;2;135;106;200m▄\e[38;2;128;110;201;48;2;131;108;201m▄\e[38;2;123;112;202;48;2;126;110;201m▄\e[38;2;118;113;202;48;2;121;112;202m▄\e[38;2;114;115;203;48;2;115;114;203m▄\e[38;2;109;117;204;48;2;111;116;204m▄\e[38;2;104;119;205;48;2;106;118;205m▄\e[38;2;100;122;205;48;2;102;124;204m▄\e[38;2;95;123;206;49m▄\e[38;2;90;125;207;49m▄\e[38;2;85;128;207;49m▄\e[38;2;80;129;208;49m▄\e[38;2;76;132;209;49m▄\e[38;2;71;133;210;49m▄\e[38;2;66;135;210;49m▄\e[38;2;62;137;211;48;2;60;134;208m▄\e[38;2;57;140;212;48;2;60;138;212m▄\e[38;2;52;142;212;48;2;54;141;213m▄\e[38;2;47;144;213;48;2;49;141;211m▄\e[38;2;43;146;214;48;2;45;144;213m▄\e[38;2;38;147;214;48;2;40;146;214m▄\e[38;2;33;150;215;48;2;36;148;215m▄\e[38;2;29;152;216;48;2;31;150;215m▄\e[38;2;23;154;216;48;2;26;152;216m▄\e[38;2;19;156;217;48;2;22;154;217m▄\e[38;2;14;158;218;48;2;17;157;217m▄\e[38;2;9;159;218;48;2;12;159;218m▄\e[38;2;5;162;219;48;2;8;160;219m▄\e[49m \e[m
\e[49m \e[49;38;2;152;98;197m▀\e[38;2;145;102;199;48;2;149;100;198m▄\e[38;2;142;104;199;48;2;144;102;199m▄\e[38;2;137;106;200;48;2;139;105;199m▄\e[38;2;132;108;200;48;2;135;107;200m▄\e[38;2;127;109;201;48;2;130;109;201m▄\e[38;2;122;112;202;48;2;125;110;201m▄\e[38;2;118;114;203;48;2;121;112;202m▄\e[38;2;113;116;203;48;2;116;115;203m▄\e[38;2;108;118;204;48;2;111;117;204m▄\e[38;2;103;120;204;48;2;106;119;204m▄\e[38;2;99;121;205;48;2;101;121;205m▄\e[38;2;94;124;206;48;2;97;122;205m▄\e[38;2;89;126;207;48;2;92;124;206m▄\e[38;2;84;128;207;48;2;87;127;207m▄\e[38;2;80;130;208;48;2;83;129;208m▄\e[38;2;75;131;209;48;2;78;131;209m▄\e[38;2;70;134;209;48;2;73;132;209m▄\e[38;2;66;136;210;48;2;68;134;210m▄\e[38;2;61;138;211;48;2;64;137;210m▄\e[38;2;56;140;212;48;2;59;139;211m▄\e[38;2;52;142;212;48;2;54;141;212m▄\e[38;2;46;144;213;48;2;49;143;213m▄\e[38;2;42;146;214;48;2;45;145;213m▄\e[38;2;37;148;214;48;2;40;147;214m▄\e[38;2;32;150;215;48;2;35;149;215m▄\e[38;2;28;152;216;48;2;30;151;215m▄\e[38;2;23;154;217;48;2;26;153;216m▄\e[38;2;18;156;217;48;2;21;155;217m▄\e[38;2;13;158;218;48;2;16;157;217m▄\e[38;2;8;160;219;48;2;11;159;218m▄\e[38;2;5;162;218;48;2;7;161;219m▄\e[49;38;2;2;164;220m▀\e[49m \e[m
\e[49m    \e[49;38;2;139;104;209m▀\e[49;38;2;129;110;200m▀\e[49;38;2;124;111;201m▀\e[49;38;2;120;113;202m▀\e[38;2;117;117;202;48;2;115;115;203m▄\e[38;2;109;117;202;48;2;110;117;204m▄\e[38;2;105;117;202;48;2;106;119;205m▄\e[38;2;100;122;207;48;2;101;121;205m▄\e[38;2;92;124;206;48;2;96;123;206m▄\e[38;2;88;126;207;48;2;92;125;206m▄\e[38;2;84;128;209;48;2;86;127;207m▄\e[38;2;79;129;208;48;2;82;129;208m▄\e[38;2;75;132;209;48;2;77;131;209m▄\e[38;2;70;134;210;48;2;73;133;209m▄\e[38;2;64;136;209;48;2;67;135;210m▄\e[38;2;60;137;211;48;2;63;137;211m▄\e[38;2;56;140;213;48;2;58;139;211m▄\e[38;2;49;142;213;48;2;53;141;212m▄\e[38;2;46;143;214;48;2;49;143;213m▄\e[38;2;42;148;217;48;2;44;145;213m▄\e[38;2;36;146;215;48;2;39;147;214m▄\e[38;2;33;152;218;48;2;35;149;215m▄\e[38;2;28;153;215;48;2;29;151;216m▄\e[49;38;2;25;153;216m▀\e[49;38;2;20;155;217m▀\e[49;38;2;15;157;217m▀\e[49;38;2;13;153;230m▀\e[49m    \e[m
\e[49m                                   \e[m
";

echo -e "\e[92m[Processing jellyfin installation]...\e[0m\n"

if [[ ! -d jellyfin-server ]]
then
mkdir jellyfin-server
fi

cd jellyfin-server

dir=$(pwd)

sys_architecture=$(dpkg --print-architecture)

if [[ ${sys_architecture} == "aarch64" ]]
then
sys_architecture=arm64
fi

wget https://repo.jellyfin.org/releases/server/linux/stable/combined/jellyfin_10.8.8_${sys_architecture}.tar.gz -O jellyfin_10.8.8_${sys_architecture}.tar.gz
tar -xf jellyfin_10.8.8_${sys_architecture}.tar.gz

sudo ln -s jellyfin_10.8.8 jellyfin

if [[ ! -d log ]]
then
mkdir data cache config log
fi

    distro=$(source /etc/os-release && echo $ID)
    case $distro in
        arch)
            pm() {
                sudo pacman -Sy --noconfirm $1
                }
            ;;
        ubuntu)
            pm() {
                sudo apt-get install -y $1
                }
            ;;
        linuxmint)
            pm() { sudo apt-get install -y $1
                }
            ;;
        kali)
            pm() { sudo apt-get install -y $1
                }
            ;;
        parrot)
            pm() { sudo apt-get install -y $1
                }
            ;;
        debian)
            pm() { sudo apt-get install -y $1
                }
            ;;
        void)
            pm() { sudo xbps-install $1
                }
            ;;
        manjaro*)
            pm() { sudo pacman -Sy $1
                }
            ;;
        garuda)
            pm() { sudo pacman -Sy $1
                }
            ;;
        alpine)
            pm() { sudo apk add $1
                }
            ;;
        gentoo)
            pm() { sudo emerge --ask $1
                }
            ;;
        fedora)
            pm() { sudo dnf install -y $1
                }
            ;;
        predator)
            pm() { sudo pacman -Sy --noconfirm $1
                }
            ;;
        artix)
            pm() { sudo pacman -Sy --noconfirm $1
                }
            ;;
        puppy_fossapup64)
            pm() { sudo pkg -d $1 && sudo pkg -i $1
                }
            ;;
        raspbian)
            pm() { sudo apt install -y $1
                }
            ;;
        endeavouros)
            pm() { sudo pacman -Sy --noconfirm $1
                }
            ;;
        freebsd)
            pm() { sudo pkg install -y $1
                }
            ;;
        *)
          echo -e "Sorry, but your System doesn't support [package manager] !
\e[92minstall: ffmpeg using your default package manager.\e[0m"
          # Add manualy to use package manager to start psfconsole !
            exit 0
            ;;
    esac

pm ffmpeg

cat <<- CONF > start.jellyfin
#!/bin/bash
JELLYFINDIR="${dir}"

\$JELLYFINDIR/jellyfin/jellyfin \
 -d \$JELLYFINDIR/data \
 -C \$JELLYFINDIR/cache \
 -c \$JELLYFINDIR/config \
 -l \$JELLYFINDIR/log \
 --ffmpeg ffmpeg
CONF

chmod +x start.jellyfin
sudo ln -s ${dir}/start.jellyfin /usr/bin/jellyfin

echo -e "\e[92mJellyfin successfully installed.\e[0m"
echo -e "\e[92mRun jellyfin server using: jellyfin\e[0m"
